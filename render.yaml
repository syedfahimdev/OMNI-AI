services:
  # Streamlit Admin Dashboard
  - type: web
    name: omni-ai-admin-dashboard
    env: python
    plan: free
    buildCommand: cd admin-dashboard && pip install -r requirements.txt
    startCommand: cd admin-dashboard && streamlit run app.py --server.port=$PORT --server.address=0.0.0.0
    envVars:
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_SERVICE_KEY
        sync: false
      - key: ADMIN_PASSWORD
        sync: false
    healthCheckPath: /

  # Next.js Website
  - type: web
    name: omni-ai-website
    env: node
    plan: free
    buildCommand: cd website && npm install && npm run build
    startCommand: cd website && sh -c "node_modules/.bin/next start -p $PORT"
    envVars:
      - key: NODE_ENV
        value: production
      - key: N8N_WEBHOOK_JWT_TOKEN
        sync: false
      - key: PORT
        value: "3000"
    healthCheckPath: /
